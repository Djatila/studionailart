<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content content="width=device-width, initial-scale=1.0">
    <title>Teste de Corre√ß√£o do BookingPage</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .log {
            background-color: #000;
            color: #00ff00;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            margin: 10px 0;
            max-height: 300px;
            overflow-y: auto;
        }
        .result {
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        input, select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 100%;
            margin: 5px 0;
        }
        .form-group {
            margin: 15px 0;
        }
        .appointment-item {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            margin: 10px 0;
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Teste de Corre√ß√£o do BookingPage</h1>
        <p>Esta ferramenta testa se a corre√ß√£o da fun√ß√£o formatPhoneNumber e da passagem de loggedClient resolveu o problema do bot√£o bloqueado.</p>
        
        <div class="form-group">
            <label>N√∫mero de Telefone (para teste):</label>
            <input type="text" id="phoneNumber" value="(11) 99999-9999" placeholder="Digite o n√∫mero de telefone">
        </div>
        
        <div class="form-group">
            <label>Nome do Cliente (para teste):</label>
            <input type="text" id="clientName" value="Cliente Teste" placeholder="Digite o nome do cliente">
        </div>
        
        <button onclick="testFormatPhoneNumber()">üìû Testar Formata√ß√£o de Telefone</button>
        <button onclick="testBookingButton()">‚úÖ Testar Bot√£o de Agendamento</button>
        <button onclick="clearLog()">üóëÔ∏è Limpar Log</button>
        
        <div id="log" class="log"></div>
        <div id="result"></div>
    </div>

    <script>
        // Fun√ß√£o para registrar logs
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `[${timestamp}] ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
            
            // Tamb√©m mostrar no console
            console.log(`[${timestamp}] ${message}`);
        }
        
        // Fun√ß√£o para mostrar resultado
        function showResult(message, type = 'info') {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `<div class="result ${type}">${message}</div>`;
        }
        
        // Fun√ß√£o corrigida para formatar o n√∫mero de telefone
        function formatPhoneNumber(phoneNumber) {
            if (!phoneNumber) return '';
            
            // Remove todos os caracteres n√£o num√©ricos
            let cleaned = phoneNumber.replace(/\D/g, '');
            
            // Se o n√∫mero come√ßar com 55 (c√≥digo do Brasil), removemos
            if (cleaned.startsWith('55')) {
                cleaned = cleaned.substring(2);
            }
            
            // Formata para o padr√£o brasileiro (XX) XXXXX-XXXX
            if (cleaned.length >= 10) {
                // Se for um n√∫mero de celular (11 d√≠gitos) ou telefone fixo (10 d√≠gitos)
                if (cleaned.length === 11) {
                    // Formato para celular: (XX) XXXXX-XXXX
                    return `(${cleaned.substring(0, 2)}) ${cleaned.substring(2, 7)}-${cleaned.substring(7, 11)}`;
                } else if (cleaned.length === 10) {
                    // Formato para telefone fixo: (XX) XXXX-XXXX
                    return `(${cleaned.substring(0, 2)}) ${cleaned.substring(2, 6)}-${cleaned.substring(6, 10)}`;
                }
            }
            
            // Se n√£o tiver o tamanho esperado, retorna o n√∫mero limpo
            return cleaned;
        }
        
        // Fun√ß√£o para testar a formata√ß√£o de telefone
        function testFormatPhoneNumber() {
            const phoneNumber = document.getElementById('phoneNumber').value;
            log('üîç Testando formata√ß√£o de telefone...', 'info');
            log(`N√∫mero original: ${phoneNumber}`, 'info');
            
            const formatted = formatPhoneNumber(phoneNumber);
            log(`N√∫mero formatado: ${formatted}`, 'info');
            
            // Verificar se o n√∫mero foi formatado corretamente
            const hasValidFormat = formatted.includes('(') && formatted.includes(')') && formatted.includes('-');
            if (hasValidFormat) {
                log('‚úÖ Formata√ß√£o correta!', 'success');
                showResult('‚úÖ Formata√ß√£o de telefone funcionando corretamente', 'success');
            } else {
                log('‚ùå Formata√ß√£o incorreta!', 'error');
                showResult('‚ùå Problema na formata√ß√£o de telefone', 'error');
            }
        }
        
        // Fun√ß√£o para testar o bot√£o de agendamento
        function testBookingButton() {
            const clientName = document.getElementById('clientName').value;
            const clientPhone = document.getElementById('phoneNumber').value;
            
            log('üîç Testando condi√ß√µes do bot√£o de agendamento...', 'info');
            log(`Nome do cliente: "${clientName}"`, 'info');
            log(`Telefone do cliente: "${clientPhone}"`, 'info');
            
            // Verificar se os campos est√£o preenchidos
            const isNameValid = clientName && clientName.trim() !== '';
            const isPhoneValid = clientPhone && clientPhone.trim() !== '';
            
            log(`Nome v√°lido: ${isNameValid}`, 'info');
            log(`Telefone v√°lido: ${isPhoneValid}`, 'info');
            
            // Simular a condi√ß√£o do bot√£o: disabled={!clientName || !clientPhone}
            const isButtonDisabled = !isNameValid || !isPhoneValid;
            
            if (isButtonDisabled) {
                log('üö´ Bot√£o estaria desabilitado!', 'error');
                showResult('üö´ Bot√£o de agendamento estaria desabilitado - campos obrigat√≥rios n√£o preenchidos', 'error');
            } else {
                log('‚úÖ Bot√£o estaria habilitado!', 'success');
                showResult('‚úÖ Bot√£o de agendamento estaria habilitado', 'success');
            }
        }
        
        // Fun√ß√£o para limpar o log
        function clearLog() {
            document.getElementById('log').innerHTML = '';
            document.getElementById('result').innerHTML = '';
        }
        
        // Executar testes iniciais ao carregar a p√°gina
        window.addEventListener('load', () => {
            log('üîß Ferramenta de teste carregada', 'info');
            log('üìã Esta ferramenta testa se as corre√ß√µes da fun√ß√£o formatPhoneNumber e da passagem de loggedClient resolveram o problema', 'info');
        });
    </script>
</body>
</html>